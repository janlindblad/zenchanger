{% extends "home/event_list_base.html" %}

{% block page_title %}Events - ZenChanger{% endblock %}

{% block navigation %}
<div class="nav-links">
    <a href="{% url 'event_create' %}">Create Event</a>
    <a href="{% url 'eventplan_create' %}">Create Event Plan</a>
    <a href="{% url 'home' %}">Home</a>
</div>
{% endblock %}

{% block page_header %}
<h2>üìÖ Events</h2>
{% endblock %}

{% block event_plans_section %}
<!-- Event Plans Section -->
{% if event_plans %}
{% include "home/components/event_plans_table.html" %}
{% endif %}
{% endblock %}

{% block events_section_header %}
<!-- Filters -->
<form method="get" class="filter-form">
    <div class="filters">
        <div class="filter-group">
            <label for="country">Country:</label>
            <select name="country" id="country">
                <option value="">All Countries</option>
                {% for country in countries %}
                <option value="{{ country.code }}" {% if current_filters.country == country.code %}selected{% endif %}>
                    {{ country.name|title }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="filter-group">
            <label for="location">Location:</label>
            <select name="location" id="location">
                <option value="">All Locations</option>
                {% for location in locations %}
                <option value="{{ location.id }}" {% if current_filters.location == location.id|stringformat:"s" %}selected{% endif %}>
                    {{ location.name|title }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="filter-group">
            <label for="date_from">From Date:</label>
            <input type="date" name="date_from" id="date_from" value="{{ current_filters.date_from }}">
        </div>

        <div class="filter-group">
            <label for="date_to">To Date:</label>
            <input type="date" name="date_to" id="date_to" value="{{ current_filters.date_to }}">
        </div>

        <div class="filter-group">
            <label for="search">Search:</label>
            <input type="text" name="search" id="search" value="{{ current_filters.search }}" placeholder="Search events...">
        </div>

        <div class="filter-group">
            <button type="submit" class="btn">Filter</button>
            <a href="{% url 'event_list' %}" class="btn btn-secondary">Clear</a>
        </div>
    </div>
</form>

<h3>üìç Individual Events</h3>
<p style="margin-bottom: 20px;">
    {% if page_obj %}
        Total events: {{ page_obj.paginator.count }}
    {% else %}
        Loading events...
    {% endif %}
</p>
{% endblock %}

{% block extra_styles %}
.filter-form {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #dee2e6;
    margin-bottom: 20px;
}

.filters {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: end;
}

.filter-group {
    display: flex;
    flex-direction: column;
}

.filter-group label {
    font-weight: bold;
    margin-bottom: 5px;
    color: #333;
}

.filter-group input, .filter-group select {
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
}

.filter-group input:focus, .filter-group select:focus {
    outline: none;
    border-color: #2d662d;
    box-shadow: 0 0 0 2px rgba(45, 102, 45, 0.2);
}
{% endblock %}

{% block pagination_params %}{% if current_filters.country %}&country={{ current_filters.country }}{% endif %}{% if current_filters.location %}&location={{ current_filters.location }}{% endif %}{% if current_filters.date_from %}&date_from={{ current_filters.date_from }}{% endif %}{% if current_filters.date_to %}&date_to={{ current_filters.date_to }}{% endif %}{% if current_filters.search %}&search={{ current_filters.search }}{% endif %}{% endblock %}

{% block pagination_params_num %}{% if current_filters.country %}&country={{ current_filters.country }}{% endif %}{% if current_filters.location %}&location={{ current_filters.location }}{% endif %}{% if current_filters.date_from %}&date_from={{ current_filters.date_from }}{% endif %}{% if current_filters.date_to %}&date_to={{ current_filters.date_to }}{% endif %}{% if current_filters.search %}&search={{ current_filters.search }}{% endif %}{% endblock %}

{% block pagination_params_next %}{% if current_filters.country %}&country={{ current_filters.country }}{% endif %}{% if current_filters.location %}&location={{ current_filters.location }}{% endif %}{% if current_filters.date_from %}&date_from={{ current_filters.date_from }}{% endif %}{% if current_filters.date_to %}&date_to={{ current_filters.date_to }}{% endif %}{% if current_filters.search %}&search={{ current_filters.search }}{% endif %}{% endblock %}